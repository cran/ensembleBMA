head	1.5;
access;
symbols;
locks
	fraley:1.5; strict;
comment	@# @;


1.5
date	2007.02.24.00.53.57;	author fraley;	state Exp;
branches;
next	1.4;

1.4
date	2007.02.24.00.34.06;	author fraley;	state Exp;
branches;
next	1.3;

1.3
date	2007.02.22.20.01.06;	author fraley;	state Exp;
branches;
next	1.2;

1.2
date	2007.02.07.19.19.34;	author fraley;	state Exp;
branches;
next	1.1;

1.1
date	2007.02.07.19.02.31;	author fraley;	state Exp;
branches;
next	;


desc
@@


1.5
log
@*** empty log message ***
@
text
@\name{fitBMAnormal}
\alias{fitBMAnormal}
\title{
    BMA for a mixture of normals.
}
\description{
   Fits a Baysian Model Averaging mixture of normals 
   to ensemble forecasting data.
}
\usage{
fitBMAnormal( ensembleData, control = controlBMAnormal()) 
}
\arguments{
  \item{ensembleData}{
     An \code{ensembleData} object with forecasts, observations and dates
     for precipitation.
  }
  \item{control}{
     A list of control values for the fitting functions. The defaults are
     given by the function \code{controlBMAnormal}.
  }
}
\value{
A list with the following output components:
  \item{biasCoefs}{
    The fitted bias-correction coefficients.
  }
  \item{sd}{
    The fitted standard deviations for the mixture of normals model.
  }
  \item{weights}{
    The fitted weights for the mixture of normals model.
  }
  \item{nIter}{
    The number of EM iterations.
  }
}
\details{
   This function fits a BMA model to a training data set. \cr
   It is called by \code{ensembleBMAnormal}, which produces a sequence
   of fits over a larger precipitation data set.  \cr
   The following methods are available for the output of \code{fitBMA}:
   \code{gridForecastBMA}, \code{quantileForecastBMA}, and 
   \code{bmaModelParameters}. 
}
\seealso{
  \code{\link{ensembleData}}, 
  \code{\link{controlBMAnormal}}, 
  \code{\link{ensembleBMAnormal}},
  \code{\link{gridForecastBMA}},
  \code{\link{quantileForecastBMA}},
  \code{\link{bmaModelParameters}}
}
\references{
A. E. Raftery, T. Gneiting, F. Balabdaoui and M. Polakowski,
Using Bayesian Model Averaging to Calibrate Forecast Ensembles,
\emph{Monthly Weather Review 133:1155-1174, 2005}.
}

\examples{
  data(slp)

  slpData <- ensembleData(forecasts = slp[c("AVN","GEM","ETA","NGM","NOGAPS")],
                          observations = slp$obs, dates = slp$date)

  DATE <- sort(unique(slpData$dates))[27]
  trainDat <- trainingData( slpData, date = DATE, trainingRule=list(length=25,lag=2))
  slpFit25a <- fitBMA(trainDat, model = "normal")

  D <- as.numeric(slpData$dates) <= 25
  slpFit25b <- fitBMA(slpData[D, ], model = "normal")
}
\keyword{models}
% docclass is function
@


1.4
log
@*** empty log message ***
@
text
@d66 2
a67 1
  trainDat <- trainingData( slpData, trainingRule=list(length=25,lag=2))
@


1.3
log
@*** empty log message ***
@
text
@a60 1
 
d66 5
a70 2
  d <- as.numeric(slpData$dates) <= 25
  slpFit25 <- fitBMAnormal(slpData[d, ], )
@


1.2
log
@*** empty log message ***
@
text
@d42 3
a44 2
  The following methods are available for the output of \code{fitBMA}:
   \code{gridForecastBMA}, \code{quantileForecastBMA}, and \code{parameters}. 
d52 1
a52 1
  \code{\link{parameters}}
d64 2
a65 3
  slpData <- ensembleData(forecasts = slp[c("AVN", "GEM", "ETA", "NGM", "NOGAPS")],
                          observations = slp$obs, dates = slp$init_date,
                          latitude = slp$lat, longitude = slp$lon)
d67 1
a67 1
  d <- as.numeric(dates(slpData)) <= 25
@


1.1
log
@Initial revision
@
text
@d63 1
a63 1
  slpData <- ensembleData(forecasts = slp[forecasts = c("AVN", "GEM", "ETA", "NGM", "NOGAPS")],
@
