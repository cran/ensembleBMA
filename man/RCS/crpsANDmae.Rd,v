head	1.14;
access;
symbols;
locks
	fraley:1.14; strict;
comment	@# @;


1.14
date	2007.02.22.19.43.49;	author fraley;	state Exp;
branches;
next	1.13;

1.13
date	2007.02.16.23.17.08;	author fraley;	state Exp;
branches;
next	1.12;

1.12
date	2007.02.15.22.53.23;	author fraley;	state Exp;
branches;
next	1.11;

1.11
date	2007.02.07.19.17.37;	author fraley;	state Exp;
branches;
next	1.10;

1.10
date	2007.02.07.18.52.48;	author fraley;	state Exp;
branches;
next	1.9;

1.9
date	2007.01.31.19.00.14;	author fraley;	state Exp;
branches;
next	1.8;

1.8
date	2007.01.31.18.44.02;	author fraley;	state Exp;
branches;
next	1.7;

1.7
date	2006.12.29.20.34.42;	author fraley;	state Exp;
branches;
next	1.6;

1.6
date	2006.12.05.21.36.52;	author fraley;	state Exp;
branches;
next	1.5;

1.5
date	2006.12.05.21.36.44;	author fraley;	state Exp;
branches;
next	1.4;

1.4
date	2006.12.05.21.20.43;	author fraley;	state Exp;
branches;
next	1.3;

1.3
date	2006.12.01.20.32.32;	author fraley;	state Exp;
branches;
next	1.2;

1.2
date	2006.11.29.18.20.02;	author fraley;	state Exp;
branches;
next	1.1;

1.1
date	2006.11.29.18.17.52;	author fraley;	state Exp;
branches;
next	;


desc
@@


1.14
log
@*** empty log message ***
@
text
@\name{crpsANDmae}
\alias{crpsANDmae}
\alias{crpsANDmae.ensembleBMAgamma0}
\alias{crpsANDmae.ensembleBMAnormal}
\title{
   CRPS and MAE via sampling
}
\description{
   Computes the continuous ranked probability score and median absolute error
   for ensemble BMA forecasting models via sampling. Can be used for
   distributions for which the CDF is not available.
}
\usage{
crpsANDmae( object, ensembleData, nSamples = 10000, seed = NULL, 
            popData = NULL, \dots)
}
\arguments{
  \item{object}{
     An ensemble BMA model fit for \code{ensembleData}.
  }
  \item{ensembleData}{
     An \code{ensembleData} object giving including ensemble
     forecasts, observations and dates corresponding to \code{object}.
  }
  \item{nSamples}{
     The number of simulation samples (gamma0 for precipitation model only)
  }
  \item{seed}{
     Argument to \code{set.seed} for random number generation in simulation.
  }
  \item{popData}{
   For \code{ensembleBMAgamma0} and \code{fitBMAgamma0} objects, there 
     is an additional \code{popData} argument for providing predictors
     in the logistic regression for probability of precipitation.
     The value of \code{popData} (if any) used to create \code{object}
     should be supplied here.
  }
  \item{\dots}{
     Included for generic function compatibility.
  }
}
\value{
A matrix whose rows correspond to the \code{crps} and
\code{mae}, respectively, and whose columns correpond
to these values for climatology,  the ensemble,
the BMA model, and simulations from the BMA model.  
}
\details{
   This method is generic, and can be applied to all ensemble BMA forecasting
   models. \cr
   Note the model may have been applied to a transformation of the data,
   but that information is included in the input \code{x}, and
   the output is transformed appropriately.\cr
   For the gamma0 model for precipitation, the CRPS is only available
   through simulation,  because a transformation of the forecast values 
   is being modeled  rather than the forecast values themselves (the 
   default transformation is the cube root). For normal models for 
   temperature and pressure,  simulation is not need and the 
   \code{nSamples} and \code{seed}  arguments are ignored.
}
\seealso{
  \code{\link{ensembleBMA}} 
}
\references{
D. A. Unger, A method  to estimate the continuous ranked probability score,
\emph{Preprints of the Ninth Conference on Probability and Statistics in
Atmospheric Sciences}, Virginia Beach, VA USA, 206-213,
American Meteorological Society.

H. Hersbach, Decomposition of the continuous ranked probability score
for ensemble prediction systems,
\emph{Weather and Forecasting 15, 559-570}.

T. Gneiting and A. E. Raftery, 
Strictly proper scoring rules, prediction and estimation, 
Technical Report No. 463R, Department of Statistics, University of
Washington, November 2006 
(to appear in \emph{Journal of the American Statistical Association}).
}

\examples{
  data(slp)
  
  slpData <- ensembleData(forecasts = slp[c("AVN","GEM","ETA","NGM","NOGAPS")],
                          observations = slp$obs, dates = slp$date)

  slpFit <- ensembleBMAnormal(slpData)

  crpsANDmae( slpFit, slpData)
}
\keyword{models}
% docclass is function
@


1.13
log
@*** empty log message ***
@
text
@d85 1
a85 2
                          observations = slp$obs, dates = slp$date,
                          latitude = slp$lat, longitude = slp$lon)
a89 15

# Note: a reduced data set and training period are used in this
# and other help file examples for fast execution. A much larger
# training period (and hence more data) is typically needed for
# good forecasting results.

  data(precip10)

  precip10data <- ensembleData( forecasts = precip10[ , 1:5],
                            observations = precip10[ , 6],
                            dates = precip10[ , 7])

  precip10fit <- ensembleBMAgamma0(precip10data,training=list(length=5,lag=2))

  crpsANDmae( precip10fit, precip10data)
@


1.12
log
@*** empty log message ***
@
text
@d84 1
a84 1
  slpData <- ensembleData(forecasts = slp[c("AVN", "GEM", "ETA", "NGM", "NOGAPS")],
@


1.11
log
@*** empty log message ***
@
text
@d14 1
a14 1
crpsANDmae( object, ensembleData, nSamples = 10000, seed = 0, 
d29 1
a29 1
     Seed for random number generation in simulation.
d43 4
a46 7
A list with the following output components:
  \item{crps}{
     Continuous ranked probability score.
  }
  \item{mae}{
     Median absolute error.
  }
d54 6
a59 6
   For the gamma0 model for precipitation, the CRPS needs to be simulated
   because a transformation of the forecast values is being modeled
   rather than the forecast values themselves (the default transformation
   is the cube root). For normal models for temperature and pressure,
   simulation is not need and the \code{nSamples} and \code{seed}
   arguments are ignored.
d85 1
a85 1
                          observations = slp$obs, dates = slp$init_date,
@


1.10
log
@*** empty log message ***
@
text
@d87 1
a87 1
  slpData <- ensembleData(forecasts = slp[forecasts = c("AVN", "GEM", "ETA", "NGM", "NOGAPS")],
@


1.9
log
@*** empty log message ***
@
text
@d86 4
a89 3

  slpData <- ensembleData(forecasts = slp[,4:8], observations = slp[,9],
               dates = slp[,1], latitude = slp[,2], longitude = slp[,3])
@


1.8
log
@*** empty log message ***
@
text
@d32 5
a36 4
      For the mixture of gammas model with a point mass at 0,
      the optional predictors (if any) the logistic regression 
      for probability of precipitation supplied in the creation 
      of \code{object}. Not used for other models.
@


1.7
log
@*** empty log message ***
@
text
@d14 2
a15 1
crpsANDmae( object, ensembleData, nSamples = 10000, seed = 0)
d31 9
d52 1
a52 1
   models. \\
d55 1
a55 1
   the output is transformed appropriately.\\
d79 2
a80 2
Washington, November 2006.\\
to appear in \emph{Journal of the American Statistical Association}.
d104 1
a104 1
  precipFit <- ensembleBMAgamma0(precip10data,training=list(length=5,lag=2))
d106 1
a106 1
  crpsANDmae( precipFit, precip10data)
@


1.6
log
@*** empty log message ***
@
text
@d4 1
d6 1
a6 1
   Continuous Ranked Probability Score and Median Absolute Error
d10 2
a11 1
   for ensemble BMA  forecasting models.
d14 1
a14 1
crpsANDmae( x, ensembleData, nSamples = 10000, seed = 0)
d17 1
a17 1
  \item{x}{
d22 1
a22 1
     forecasts, observations and dates. 
d54 1
a54 2
  \code{\link{ensembleBMA}}, 
  \code{\link{quant}}
d68 1
a68 1
Technical Report No. 463R, Department of Statistics, Univeristy of
d74 8
d90 3
a92 3
  precip10 <- ensembleData( forecasts = precip10[,1:9],
                             observations = precip10[, 10],
                             dates = precip10[, 11])
d94 1
a94 1
  precipFit <- ensembleBMAgamma0(precip10,training=list(length=5,lag=2))
d96 1
a96 1
  crpsANDmae( precipFit, precip10)
@


1.5
log
@*** empty log message ***
@
text
@a73 1

@


1.4
log
@*** empty log message ***
@
text
@d74 1
d76 3
a78 1
# example for fast execution.
@


1.3
log
@*** empty log message ***
@
text
@a72 1
  data(precip20)
d74 2
a75 3
  precip20 <- ensembleData( forecasts = precip20[,1:9],
                             observations = precip20[, 10],
                             dates = precip20[, 11])
d77 1
a77 1
  precipFit <- ensembleBMAgamma0(precip20,training=list(length=15,lag=2))
d79 7
a85 1
  crpsANDmae( precipFit, precip20)
@


1.2
log
@*** empty log message ***
@
text
@d12 1
a12 1
crpsANDmae( x, weatherData, nSamples = 10000, seed = 0, ...)
d16 1
a16 1
     An ensemble BMA model fit for \code{weatherData}.
d18 2
a19 2
  \item{weatherData}{
     A \code{weatherData} object giving including ensemble
d73 1
a73 3
  precipData <- weatherData( forecasts = precipData[,1:9],
                             observations = precipData[, 10],
                             dates = precipData[, 11])
d75 3
a77 1
  precipFit <- ensembleBMAgamma0(precipData)
d79 3
a81 1
  crpsANDmae( precipFit, precipData)
d83 1
a83 1
\keyword{BMA}
@


1.1
log
@Initial revision
@
text
@d41 3
@
